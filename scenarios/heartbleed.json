{
  "name": "heartbleed_attack",
  "description": "Simulate CVE-2014-0160 (Heartbleed): MITM sends malicious heartbeat request.",
  "anomaly": {
    "severity": "High",
    "status": "detected",
    "detail": "Unusual heartbeat response - possible memory leak detected.",
    "findings": [
      {"type": "heartbeat_overread", "severity": "High", "description": "Server returned more data than requested", "detail": "Potential buffer over-read"}
    ],
    "timestamp": "2025-09-18T00:00:00",
    "risk_score": 75
  },
  "client": {
    "kem_offers": [
      "X25519"
    ],
    "sig_offers": [
      "ecdsa_secp256r1_sha256"
    ],
    "versions": [
      "TLS1.2"
    ]
  },
  "server": {
    "kem_offers": [
      "X25519"
    ],
    "sig_offers": [
      "ecdsa_secp256r1_sha256"
    ],
    "versions": [
      "TLS1.2"
    ]
  },
  "mitm": {
    "enabled": true,
    "actions": [
      {
        "type": "send_heartbeat_overflow"
      }
    ]
  },
  "expected": {
    "detection": "heartbeat_overflow",
    "mitigation": "abort_connection"
  },
  "transcript": "[=] client: ClientHello kem=['X25519'], sigs=['ecdsa_secp256r1_sha256']\n[=] server: ServerHello selects kem=X25519, sig=ecdsa_secp256r1_sha256\n[=] report: TLS Version: TLS1.3, PQ: Classical Only",
  "last_run": "2025-09-18T18:04:45.503651",
  "alerts": [],
  "selected_kem": "X25519",
  "selected_sig": "ecdsa_secp256r1_sha256"
  ,
  "anomaly": {
    "severity": "High",
    "description": "Heartbeat response indicates memory disclosure potential (Heartbleed pattern detected).",
    "rules": ["heartbeat_overflow"],
    "timestamp": "2025-09-18T18:05:00.000000"
  }
}