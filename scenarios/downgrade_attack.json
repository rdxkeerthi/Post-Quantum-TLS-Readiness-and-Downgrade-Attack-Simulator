{
  "name": "downgrade_attack",
  "description": "Simulate generic TLS downgrade attack: MITM strips PQ/hybrid ciphers and forces TLS 1.2.",
  "client": {
    "kem_offers": [
      "X25519",
      "KYBER1024",
      "HYBRID_X25519_KYBER1024"
    ],
    "sig_offers": [
      "ecdsa_secp256r1_sha256",
      "falcon-1024",
      "hybrid_ecdsa_falcon1024"
    ],
    "versions": [
      "TLS1.2",
      "TLS1.3"
    ]
  },
  "server": {
    "kem_offers": [
      "X25519",
      "KYBER1024",
      "HYBRID_X25519_KYBER1024"
    ],
    "sig_offers": [
      "ecdsa_secp256r1_sha256",
      "falcon-1024",
      "hybrid_ecdsa_falcon1024"
    ],
    "versions": [
      "TLS1.2",
      "TLS1.3"
    ]
  },
  "mitm": {
    "enabled": true,
    "actions": [
      {
        "type": "strip_pq_ciphers"
      },
      {
        "type": "force_version",
        "version": "TLS1.2"
      }
    ]
  },
  "expected": {
    "detection": "pq_downgrade",
    "mitigation": "abort_handshake"
  },
  "transcript": "[=] client: ClientHello kem=['X25519', 'KYBER1024', 'HYBRID_X25519_KYBER1024'], sigs=['ecdsa_secp256r1_sha256', 'falcon-1024', 'hybrid_ecdsa_falcon1024']\n[=] server: ServerHello selects kem=X25519, sig=ecdsa_secp256r1_sha256\n[!] detector: Possible downgrade: PQ supported but classical negotiated.\n[=] report: TLS Version: TLS1.3, PQ: Classical Only",
  "last_run": "2025-09-18T17:52:00.585899",
  "alerts": [
    "Possible downgrade: PQ supported but classical negotiated."
  ],
  "selected_kem": "X25519",
  "selected_sig": "ecdsa_secp256r1_sha256"
  ,
  "anomaly": {
    "severity": "Critical",
    "description": "PQ algorithm offers were stripped by MITM and negotiation fell back to classical ciphers - downgrade detected.",
    "rules": ["pq_downgrade"],
    "timestamp": "2025-09-18T17:52:12.000000"
  }
}